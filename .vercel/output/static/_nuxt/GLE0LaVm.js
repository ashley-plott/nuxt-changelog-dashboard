import{g as V,j as N,r as d,c,a as e,m as l,k as v,v as f,p as x,l as w,t as y,n as P,o as b}from"#entry";const S={class:"p-6 max-w-2xl space-y-6"},T={class:"border rounded-xl p-5 space-y-4 bg-white"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},B=["value"],U=["value"],$={class:"md:col-span-2"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"flex gap-3"},R={key:0,class:"text-emerald-700 text-sm"},j={key:1,class:"text-red-600 text-sm"},L=V({__name:"account",async setup(F){let u,g;const m=([u,g]=N(()=>$fetch("/api/auth/me")),u=await u,g(),u),i=d(m?.user?.name||""),_=m?.user?.email,k=m?.user?.role,t=d(""),a=d(""),r=d(null),o=d(null);async function h(){if(r.value=o.value=null,t.value||a.value){if(t.value!==a.value){o.value="Passwords do not match";return}if(t.value.length<8){o.value="Password too short";return}}try{await $fetch("/api/auth/profile",{method:"PATCH",body:{name:i.value,password:t.value||void 0}}),r.value="Saved"}catch(p){o.value=p?.data?.message||p?.message||"Failed"}}async function C(){await $fetch("/api/auth/logout",{method:"POST"}),P("/login")}return(p,s)=>(b(),c("div",S,[e("div",{class:"flex items-center gap-3"},[s[3]||(s[3]=e("h1",{class:"text-2xl font-bold"},"Account",-1)),e("button",{onClick:C,class:"ml-auto text-sm underline"},"Logout")]),e("div",T,[e("div",A,[e("div",null,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium"},"Email",-1)),e("input",{value:l(_),disabled:"",class:"border rounded px-3 py-2 w-full bg-gray-50"},null,8,B)]),e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium"},"Role",-1)),e("input",{value:l(k),disabled:"",class:"border rounded px-3 py-2 w-full bg-gray-50"},null,8,U)]),e("div",$,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium"},"Name",-1)),v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>x(i)?i.value=n:null),class:"border rounded px-3 py-2 w-full"},null,512),[[f,l(i)]])])]),e("div",D,[e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium"},"New password",-1)),v(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>x(t)?t.value=n:null),type:"password",class:"border rounded px-3 py-2 w-full"},null,512),[[f,l(t)]])]),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium"},"Confirm password",-1)),v(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>x(a)?a.value=n:null),type:"password",class:"border rounded px-3 py-2 w-full"},null,512),[[f,l(a)]])])]),e("div",E,[e("button",{onClick:h,class:"px-4 py-2 rounded bg-black text-white"},"Save"),l(r)?(b(),c("p",R,y(l(r)),1)):w("",!0),l(o)?(b(),c("p",j,y(l(o)),1)):w("",!0)])])]))}});export{L as default};
